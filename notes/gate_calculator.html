<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scientific Calculator</title>
    <style>
        :root {
            --bg-color: #E3E3E3;
            --header-bg: #4A89DC;
            --display-bg: #FFFFFF;
            --display-border: #BDBDBD;
            --button-light-bg: #F5F5F5;
            --button-dark-bg: #E8E8E8;
            --button-hover-bg: #D6D6D6;
            --button-red: #D9534F;
            --button-red-hover: #C9302C;
            --button-green: #5CB85C;
            --button-green-hover: #449D44;
            --text-dark: #000000;
            --text-light: #FFFFFF;
        }

        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        .calculator-container {
            width: 100%;
            max-width: 820px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
        }

        .calculator-header {
            background-color: var(--header-bg);
            color: var(--text-light);
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .calculator-header a {
            color: var(--text-light);
            text-decoration: none;
            font-size: 1rem;
            font-weight: normal;
        }

        .calculator-body {
            background-color: var(--bg-color);
            padding: 15px;
        }
        
        .calculator-display {
            background-color: var(--display-bg);
            border: 1px solid var(--display-border);
            border-radius: 6px;
            padding: 5px 15px;
            margin-bottom: 15px;
            text-align: right;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        #history-display {
            min-height: 24px;
            font-size: 1rem;
            color: #666;
            border-bottom: 1px solid #eee;
            margin-bottom: 5px;
            padding-bottom: 5px;
            overflow-x: auto;
            white-space: nowrap;
        }

        #main-display {
            font-size: 2.8rem;
            color: var(--text-dark);
            min-height: 55px;
            font-weight: normal;
            overflow-x: auto;
            white-space: nowrap;
            line-height: 55px;
        }

        .controls-grid {
            display: grid;
            gap: 8px;
        }

        .top-controls {
            display: grid;
            grid-template-columns: 1fr 2fr 5fr;
            gap: 8px;
            margin-bottom: 8px;
            align-items: center;
        }
        
        .memory-controls {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }
        
        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(11, 1fr);
            gap: 8px;
        }

        .btn {
            height: 45px;
            font-size: 1rem;
            border: 1px solid #bbb;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s;
            background-color: var(--button-light-bg);
            color: var(--text-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 2px rgba(0,0,0,0.1);
        }
        
        .btn:active {
            box-shadow: inset 0 2px 2px rgba(0,0,0,0.15);
            transform: translateY(1px);
        }
        
        .btn-dark {
            background-color: var(--button-dark-bg);
        }
        
        .btn-red {
            background-color: var(--button-red);
            color: var(--text-light);
            font-weight: bold;
        }
        .btn-red:hover { background-color: var(--button-red-hover); }

        .btn-green {
            background-color: var(--button-green);
            color: var(--text-light);
            font-size: 1.5rem;
            grid-row: span 2;
            height: auto;
        }
        .btn-green:hover { background-color: var(--button-green-hover); }
        
        .btn-zero {
            grid-column: span 2;
        }
        
        .top-controls .btn {
            height: 35px;
            font-size: 0.9rem;
        }

        .deg-rad-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .deg-rad-toggle input { margin: 0 5px 0 10px; }
    </style>
</head>
<body>

    <div class="calculator-container">
        <header class="calculator-header">
            <span>Scientific Calculator</span>
            <a href="#">Help</a>
        </header>
        <main class="calculator-body">
            <div class="calculator-display">
                <div id="history-display"></div>
                <div id="main-display">0</div>
            </div>

            <div class="controls-grid">
                <div class="top-controls">
                    <button class="btn btn-dark" data-action="operator" data-value="%">mod</button>
                    <div class="deg-rad-toggle">
                        <input type="radio" id="deg" name="angle-mode" value="deg" checked>
                        <label for="deg">Deg</label>
                        <input type="radio" id="rad" name="angle-mode" value="rad">
                        <label for="rad">Rad</label>
                    </div>
                    <div class="memory-controls">
                        <button class="btn btn-dark" data-action="memory-clear">MC</button>
                        <button class="btn btn-dark" data-action="memory-recall">MR</button>
                        <button class="btn btn-dark" data-action="memory-store">MS</button>
                        <button class="btn btn-dark" data-action="memory-add">M+</button>
                        <button class="btn btn-dark" data-action="memory-subtract">M-</button>
                    </div>
                </div>

                <div id="button-grid" class="calculator-buttons">
                    <!-- Row 1 -->
                    <button class="btn btn-dark" data-action="sinh">sinh</button>
                    <button class="btn btn-dark" data-action="cosh">cosh</button>
                    <button class="btn btn-dark" data-action="tanh">tanh</button>
                    <button class="btn btn-dark" data-action="exp">Exp</button>
                    <button class="btn btn-dark" data-action="parenthesis" data-value="(">(</button>
                    <button class="btn btn-dark" data-action="parenthesis" data-value=")">)</button>
                    <button class="btn btn-red" data-action="backspace">&larr;</button>
                    <button class="btn btn-red" data-action="clear">C</button>
                    <button class="btn btn-dark" data-action="negate">+/-</button>
                    <button class="btn btn-dark" data-action="sqrt">&radic;</button>
                    <button class="btn btn-dark" data-action="percentage">%</button>
                    
                    <!-- Row 2 -->
                    <button class="btn btn-dark" data-action="asinh">sinh<sup>-1</sup></button>
                    <button class="btn btn-dark" data-action="acosh">cosh<sup>-1</sup></button>
                    <button class="btn btn-dark" data-action="atanh">tanh<sup>-1</sup></button>
                    <button class="btn btn-dark" data-action="log2">log<sub>2</sub>x</button>
                    <button class="btn btn-dark" data-action="ln">ln</button>
                    <button class="btn btn-dark" data-action="log10">log</button>
                    <button class="btn" data-action="number" data-value="7">7</button>
                    <button class="btn" data-action="number" data-value="8">8</button>
                    <button class="btn" data-action="number" data-value="9">9</button>
                    <button class="btn btn-dark" data-action="operator" data-value="/">&divide;</button>
                    <button class="btn btn-dark" data-action="reciprocal">1/x</button>

                    <!-- Row 3 -->
                    <button class="btn btn-dark" data-action="pi">&pi;</button>
                    <button class="btn btn-dark" data-action="e">e</button>
                    <button class="btn btn-dark" data-action="factorial">n!</button>
                    <button class="btn btn-dark" data-action="log-y">log<sub>y</sub>x</button>
                    <button class="btn btn-dark" data-action="exp-e">e<sup>x</sup></button>
                    <button class="btn btn-dark" data-action="exp-10">10<sup>x</sup></button>
                    <button class="btn" data-action="number" data-value="4">4</button>
                    <button class="btn" data-action="number" data-value="5">5</button>
                    <button class="btn" data-action="number" data-value="6">6</button>
                    <button class="btn btn-dark" data-action="operator" data-value="*">&times;</button>
                    <button class="btn btn-green" data-action="equals">=</button>
                    
                    <!-- Row 4 -->
                    <button class="btn btn-dark" data-action="sin">sin</button>
                    <button class="btn btn-dark" data-action="cos">cos</button>
                    <button class="btn btn-dark" data-action="tan">tan</button>
                    <button class="btn btn-dark" data-action="power-y">x<sup>y</sup></button>
                    <button class="btn btn-dark" data-action="power-3">x<sup>3</sup></button>
                    <button class="btn btn-dark" data-action="power-2">x<sup>2</sup></button>
                    <button class="btn" data-action="number" data-value="1">1</button>
                    <button class="btn" data-action="number" data-value="2">2</button>
                    <button class="btn" data-action="number" data-value="3">3</button>
                    <button class="btn btn-dark" data-action="operator" data-value="-">-</button>
                    
                    <!-- Row 5 -->
                    <button class="btn btn-dark" data-action="asin">sin<sup>-1</sup></button>
                    <button class="btn btn-dark" data-action="acos">cos<sup>-1</sup></button>
                    <button class="btn btn-dark" data-action="atan">tan<sup>-1</sup></button>
                    <button class="btn btn-dark" data-action="cuberoot"><sup>3</sup>&radic;x</button>
                    <button class="btn btn-dark" data-action="yroot"><sup>y</sup>&radic;x</button>
                    <button class="btn btn-dark" data-action="abs">|x|</button>
                    <button class="btn btn-zero" data-action="number" data-value="0">0</button>
                    <button class="btn" data-action="decimal">.</button>
                    <button class="btn btn-dark" data-action="operator" data-value="+">+</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainDisplay = document.getElementById('main-display');
            const historyDisplay = document.getElementById('history-display');
            const angleModeRadios = document.getElementsByName('angle-mode');

            let currentInput = '0';
            let expression = '';
            let memory = 0;
            let isResult = false;
            let angleMode = 'deg';

            document.querySelector('.controls-grid').addEventListener('click', handleButtonClick);
            
            angleModeRadios.forEach(radio => radio.addEventListener('change', (e) => angleMode = e.target.value));
            
            function handleButtonClick(event) {
                const target = event.target.closest('.btn');
                if (!target) return;

                const { action, value } = target.dataset;

                if (action === 'number') handleNumber(value);
                else if (action === 'operator') handleOperator(value);
                else if (action === 'decimal') handleDecimal();
                else if (action === 'clear') handleClear();
                else if (action === 'backspace') handleBackspace();
                else if (action === 'equals') handleEquals();
                else if (action === 'negate') handleNegate();
                else if (action.startsWith('memory')) handleMemory(action);
                else if (action === 'parenthesis') handleParenthesis(value);
                else handleFunction(action);
            }
            
            function handleNumber(num) {
                if (isResult || currentInput === '0' && num !== '.') {
                    currentInput = num;
                    isResult = false;
                } else {
                    currentInput += num;
                }
                updateDisplay();
            }

            function handleOperator(op) {
                if (currentInput === '' && expression !== '' && !expression.endsWith(')')) {
                    expression = expression.slice(0, -1) + op;
                } else {
                    expression += currentInput + op;
                    currentInput = '';
                }
                isResult = false;
                updateDisplay();
            }
            
             function handleDecimal() {
                if (isResult) {
                    currentInput = '0.';
                    isResult = false;
                } else if (!currentInput.includes('.')) {
                    currentInput = (currentInput === '') ? '0.' : currentInput + '.';
                }
                updateDisplay();
            }

            function handleClear() {
                currentInput = '0';
                expression = '';
                isResult = false;
                updateDisplay();
            }

            function handleBackspace() {
                if (currentInput.length > 1) {
                    currentInput = currentInput.slice(0, -1);
                } else {
                    currentInput = '0';
                }
                updateDisplay();
            }

            function handleEquals() {
                if (expression === '' && currentInput === '0') return;
                const finalExpression = (expression + currentInput).replace(/--/g, '+');
                historyDisplay.textContent = finalExpression.replace(/\*/g, '×').replace(/\//g, '÷') + '=';

                try {
                    const calculate = new Function('return ' + sanitizeExpression(finalExpression));
                    let result = calculate();
                    result = parseFloat(result.toPrecision(15));
                    
                    mainDisplay.textContent = result;
                    currentInput = result.toString();
                    expression = '';
                    isResult = true;
                } catch (error) {
                    mainDisplay.textContent = 'Error';
                    currentInput = '0';
                    expression = '';
                    isResult = true;
                }
            }
            
            function handleNegate() {
                if (currentInput !== '0') {
                    currentInput = (parseFloat(currentInput) * -1).toString();
                }
                updateDisplay();
            }

            function handleMemory(memAction) {
                const currentValue = parseFloat(currentInput);
                switch (memAction) {
                    case 'memory-store': memory = currentValue; break;
                    case 'memory-recall': currentInput = memory.toString(); break;
                    case 'memory-clear': memory = 0; break;
                    case 'memory-add': memory += currentValue; break;
                    case 'memory-subtract': memory -= currentValue; break;
                }
                isResult = true;
                updateDisplay();
            }
            
            function handleFunction(func) {
                let value = parseFloat(currentInput);
                let result;
                
                try {
                    switch(func) {
                        case 'sin': result = angleMode === 'deg' ? Math.sin(value * Math.PI / 180) : Math.sin(value); break;
                        case 'cos': result = angleMode === 'deg' ? Math.cos(value * Math.PI / 180) : Math.cos(value); break;
                        case 'tan': result = angleMode === 'deg' ? Math.tan(value * Math.PI / 180) : Math.tan(value); break;
                        case 'asin': result = angleMode === 'deg' ? Math.asin(value) * 180 / Math.PI : Math.asin(value); break;
                        case 'acos': result = angleMode === 'deg' ? Math.acos(value) * 180 / Math.PI : Math.acos(value); break;
                        case 'atan': result = angleMode === 'deg' ? Math.atan(value) * 180 / Math.PI : Math.atan(value); break;
                        case 'sinh': result = Math.sinh(value); break;
                        case 'cosh': result = Math.cosh(value); break;
                        case 'tanh': result = Math.tanh(value); break;
                        case 'asinh': result = Math.asinh(value); break;
                        case 'acosh': result = Math.acosh(value); break;
                        case 'atanh': result = Math.atanh(value); break;
                        case 'log10': result = Math.log10(value); break;
                        case 'ln': result = Math.log(value); break;
                        case 'log2': result = Math.log2(value); break;
                        case 'sqrt': result = Math.sqrt(value); break;
                        case 'cuberoot': result = Math.cbrt(value); break;
                        case 'power-2': result = Math.pow(value, 2); break;
                        case 'power-3': result = Math.pow(value, 3); break;
                        case 'exp-e': result = Math.exp(value); break;
                        case 'exp-10': result = Math.pow(10, value); break;
                        case 'reciprocal': result = 1 / value; break;
                        case 'abs': result = Math.abs(value); break;
                        case 'factorial': result = factorial(value); break;
                        case 'pi': currentInput = Math.PI.toString(); updateDisplay(); return;
                        case 'e': currentInput = Math.E.toString(); updateDisplay(); return;
                        case 'percentage':
                             if (expression) {
                                const lastNumMatch = expression.match(/(\d+(\.\d+)?)(\D+)$/);
                                if (lastNumMatch) {
                                    const lastNum = parseFloat(lastNumMatch[1]);
                                    currentInput = (lastNum * (value / 100)).toString();
                                }
                            }
                            updateDisplay();
                            return;
                        case 'exp': handleOperator('*10**'); return;
                        case 'power-y': handleOperator('**'); return;
                        case 'log-y': handleOperator(','); return;
                        case 'yroot': handleOperator('**(1/'); return;
                        default: return;
                    }
                    currentInput = parseFloat(result.toPrecision(15)).toString();
                    isResult = true;
                    updateDisplay();
                } catch(e) {
                    currentInput = 'Error'; isResult = true; updateDisplay();
                }
            }

            function handleParenthesis(paren) {
                if (isResult) { currentInput = ''; isResult = false; }
                currentInput += paren;
                updateDisplay();
            }

            function updateDisplay() {
                mainDisplay.textContent = currentInput;
                historyDisplay.textContent = expression.replace(/\*/g, '×').replace(/\//g, '÷');
            }
            
            function sanitizeExpression(expr) {
                let sanitized = expr.replace(/(\d+),(\d+)/g, 'Math.log($2)/Math.log($1)');
                sanitized = sanitized.replace(/(\d+)\*\*\(1\/(\d+)\)/g, 'Math.pow($1, 1/$2)');
                sanitized = sanitized.replace(/(\d)\(/g, '$1*(');
                sanitized = sanitized.replace(/\)(\d)/g, ')*$1');
                return sanitized;
            }

            function factorial(n) {
                if (n < 0 || n % 1 !== 0) throw new Error("Invalid input");
                if (n > 170) throw new Error("Overflow");
                if (n === 0 || n === 1) return 1;
                let result = 1;
                for (let i = 2; i <= n; i++) result *= i;
                return result;
            }
        });
    </script>

</body>
</html>
